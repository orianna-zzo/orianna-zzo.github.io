<!DOCTYPE html>
<html lang="zh-CN">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="ZHENG Zi&#39;ou">
<meta name="description" content="前言 上周五小仓鼠说有篇论文很有意思，问我看过没，是ICLR 2017 的 Best Paper [Zhang et al. 2017] Understanding Deep Learning Requires Rethinking Generalization。汗颜的确很久没有关心会议论文，现在更多都是关心项目技术点方向的论文。这篇论文一看的确很有意思，而且在学术界引起了非常激烈的讨论。有些人认为论文深度不够，提出的观点在泛化的理论学界已经研究很久，更偏向于实验报告不足以Best Paper，有人说中间有些逻辑问题，也有不少人觉得是对传统理论发起进攻的flag。这引起了我的兴趣，于是替换了我最近打算实现的NER的论文作为精读系列第一篇。
Zhang C, Bengio S, Hardt M, et al. Deep Learning Requires Rethinking Generalization[C]// International Conference on Learning Representation. 2017:1-14.
论文概要 作者通过一系列实验，展现出神经网络强大的拟合能力及现有的正则化方法的局限性，并提出传统机器学习中的泛化理论并不适用于深度学习，并说明即使在线性模型中，泛化理论实际上也没这么简单。
Contributions  展现神经网络的强大拟合能力
通过不同程度随机或根据一定规则修改数据集标签（部分错误的标签数据集、随机标签的数据集）及修改数据集图片（图片的像素点打乱的数据集(shuffled、random，前者根据打乱一部分像素，后者完全打乱)、根据高斯分布生成的新数据集）两种方式来进行实验，使用随机梯度下降SGD并使用相同的超参，(Figure 1)发现Inception模型在CIFAR10的各种数据集上都能100%拟合，只是不同噪声的数据集收敛速度有所不同（但也相差并没有太多），而一旦开始收敛，都能很快拟合。随机标签被认为是对数据的一次transformation，也就是说学习算法的uniform stability和训练数据的标签是独立的。
作者还提出不同于之前在&rdquo;population level&rdquo;对于特定function family在整个领域的表达能力，认为需要关注给定样本大小\(n\)情况下，也就是有限样本的网络的表达能力，并在文中证明2层使用ReLU作为激活函数并有\(2n&#43;d\)参数的神经网络就已经有足够的capacity去表示\(d\)维的样本大小为\(n\)数据集。
 现有显式正则化方法的局限性
通过在真实数据集和随机标签数据集(CIFAR10、ImageNet2012)上，分别对不同的显式正则化方法(explicit regularization)进行试验，发现(Table 1&amp;2)：
 random crop的数据增强方法在CIFAR10中使用不同网结构络(Inception、Alexnet)的试验中基本都能提高3%~4%的测试准确率，在ImageNet中能提高10%甚至以上。 Weight decay(\(l2\)正则化)在CIFAR10中能提高1%左右测试准确率，但有时会降低0.1% ~ 0.3%（Inception使用数据增强、MLP1层），在ImageNet中提高了6% ~ 8%（没有CIFAR10降低的对比情况）。 dropout并没有控制变量的对比试验。 即使加入了显式正则化方法(explicit regularization)，随机标签的数据集一样能有很高的拟合程度，CIFAR10都能达到99%以上，ImageNet中最低的也有87%，其他也都在90%以上。  基于以上发现，作者认为在CIFAR10上explicit regularization只提高了4% ~ 5%，在ImageNet上也只提高了18%，不算数据增强部分，在CIFAR10上提高1%，在ImageNet也有9% ~12%的提高。相比于改进网络结构，explicit regularization提高并不明显、不是必须步骤，而有些网络模型本身就具有了一定的泛化能力。此外，即使加入了正则化方法，训练集上的error还是能保持在很低的水平，作者认为显式正则化可能提高了模型的泛化能力，但对控制泛化误差不是必要的也并不足够。">

<meta property="og:title" content="每周Paper精读(1) Understanding Deep Learning Requires Rethinking Generalization" />
<meta property="og:description" content="前言 上周五小仓鼠说有篇论文很有意思，问我看过没，是ICLR 2017 的 Best Paper [Zhang et al. 2017] Understanding Deep Learning Requires Rethinking Generalization。汗颜的确很久没有关心会议论文，现在更多都是关心项目技术点方向的论文。这篇论文一看的确很有意思，而且在学术界引起了非常激烈的讨论。有些人认为论文深度不够，提出的观点在泛化的理论学界已经研究很久，更偏向于实验报告不足以Best Paper，有人说中间有些逻辑问题，也有不少人觉得是对传统理论发起进攻的flag。这引起了我的兴趣，于是替换了我最近打算实现的NER的论文作为精读系列第一篇。
Zhang C, Bengio S, Hardt M, et al. Deep Learning Requires Rethinking Generalization[C]// International Conference on Learning Representation. 2017:1-14.
论文概要 作者通过一系列实验，展现出神经网络强大的拟合能力及现有的正则化方法的局限性，并提出传统机器学习中的泛化理论并不适用于深度学习，并说明即使在线性模型中，泛化理论实际上也没这么简单。
Contributions  展现神经网络的强大拟合能力
通过不同程度随机或根据一定规则修改数据集标签（部分错误的标签数据集、随机标签的数据集）及修改数据集图片（图片的像素点打乱的数据集(shuffled、random，前者根据打乱一部分像素，后者完全打乱)、根据高斯分布生成的新数据集）两种方式来进行实验，使用随机梯度下降SGD并使用相同的超参，(Figure 1)发现Inception模型在CIFAR10的各种数据集上都能100%拟合，只是不同噪声的数据集收敛速度有所不同（但也相差并没有太多），而一旦开始收敛，都能很快拟合。随机标签被认为是对数据的一次transformation，也就是说学习算法的uniform stability和训练数据的标签是独立的。
作者还提出不同于之前在&rdquo;population level&rdquo;对于特定function family在整个领域的表达能力，认为需要关注给定样本大小\(n\)情况下，也就是有限样本的网络的表达能力，并在文中证明2层使用ReLU作为激活函数并有\(2n&#43;d\)参数的神经网络就已经有足够的capacity去表示\(d\)维的样本大小为\(n\)数据集。
 现有显式正则化方法的局限性
通过在真实数据集和随机标签数据集(CIFAR10、ImageNet2012)上，分别对不同的显式正则化方法(explicit regularization)进行试验，发现(Table 1&amp;2)：
 random crop的数据增强方法在CIFAR10中使用不同网结构络(Inception、Alexnet)的试验中基本都能提高3%~4%的测试准确率，在ImageNet中能提高10%甚至以上。 Weight decay(\(l2\)正则化)在CIFAR10中能提高1%左右测试准确率，但有时会降低0.1% ~ 0.3%（Inception使用数据增强、MLP1层），在ImageNet中提高了6% ~ 8%（没有CIFAR10降低的对比情况）。 dropout并没有控制变量的对比试验。 即使加入了显式正则化方法(explicit regularization)，随机标签的数据集一样能有很高的拟合程度，CIFAR10都能达到99%以上，ImageNet中最低的也有87%，其他也都在90%以上。  基于以上发现，作者认为在CIFAR10上explicit regularization只提高了4% ~ 5%，在ImageNet上也只提高了18%，不算数据增强部分，在CIFAR10上提高1%，在ImageNet也有9% ~12%的提高。相比于改进网络结构，explicit regularization提高并不明显、不是必须步骤，而有些网络模型本身就具有了一定的泛化能力。此外，即使加入了正则化方法，训练集上的error还是能保持在很低的水平，作者认为显式正则化可能提高了模型的泛化能力，但对控制泛化误差不是必要的也并不足够。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://orianna-zzo.github.io/blog/2018-03/%E6%AF%8F%E5%91%A8paper%E7%B2%BE%E8%AF%BB1-understanding-deep-learning-requires-rethinking-generalization/" />



<meta property="article:published_time" content="2018-03-14T10:40:55&#43;08:00"/>

<meta property="article:modified_time" content="2018-03-14T10:40:55&#43;08:00"/>






  
  








<title>


     每周Paper精读(1) Understanding Deep Learning Requires Rethinking Generalization 

</title>
<link rel="canonical" href="https://orianna-zzo.github.io/blog/2018-03/%E6%AF%8F%E5%91%A8paper%E7%B2%BE%E8%AF%BB1-understanding-deep-learning-requires-rethinking-generalization/">










<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500">



    
    <link rel="stylesheet" href="https://orianna-zzo.github.io/css/reset.css?t=2018-08-04%2017%3a54%3a21.457295348%20%2b0000%20UTC%20m%3d%2b0.252378214">
    <link rel="stylesheet" href="https://orianna-zzo.github.io/css/pygments.css?t=2018-08-04%2017%3a54%3a21.457295348%20%2b0000%20UTC%20m%3d%2b0.252378214">
    <link rel="stylesheet" href="https://orianna-zzo.github.io/css/main.css?t=2018-08-04%2017%3a54%3a21.457295348%20%2b0000%20UTC%20m%3d%2b0.252378214">
    
        <link rel="stylesheet" href="https://orianna-zzo.github.io/css/override.css?t=2018-08-04%2017%3a54%3a21.457295348%20%2b0000%20UTC%20m%3d%2b0.252378214">
    




<link rel="shortcut icon"

    href="https://orianna-zzo.github.io/img/profile.png"

>










<link rel="stylesheet" href="https://orianna-zzo.github.io/js/katex/katex.min.css" >
<script src="https://orianna-zzo.github.io/js/katex/katex.min.js" > </script>
<script src="https://orianna-zzo.github.io/js/katex/contrib/auto-render.min.js" ></script>
 
<script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body);
    });
</script>
 

</head>


<body lang="">

<section class="header">
    <div class="container">
        <div class="content">
            
                
                
                
                
                
                    
                
                    
                
                    
                
                
                <a href="https://orianna-zzo.github.io/"><img class="avatar" src="https://orianna-zzo.github.io/img/profile.png" srcset="https://orianna-zzo.github.io/img/profile.png 1x"></a>
            
            <a href="https://orianna-zzo.github.io/"><div class="name">ZHENG Zi&#39;ou</div></a>
            
              <h3 class="self-intro">Be myself. Love the wonderful world. Do the right things in the right way.</h3>
            
            <nav>
                <ul>
                    
                        <li class="nav-blog"><a href="https://orianna-zzo.github.io/blog/"><span>Blog</span></a></li>
                    
                        <li class="nav-about"><a href="https://orianna-zzo.github.io/about/"><span>About</span></a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</section>

<section class="icons">
    <div class="container">
        <div class="content">
        
            <a href="//github.com/orianna-zzo" target="_blank" rel="noopener"><img class="icon" src="https://orianna-zzo.github.io/img/github.svg" alt="github" /></a>
        

        

	

        

        

        
            <a href="//linkedin.com/in/ziouzheng" target="_blank" rel="noopener"><img class="icon" src="https://orianna-zzo.github.io/img/linkedin.svg" alt="linkedin" /></a>
        

        

        

        

        

        
            <a href="mailto:zhengziou@gmail.com"><img class="icon" src="https://orianna-zzo.github.io/img/email.svg" alt="email" /></a>
        

        

        
        </div>
    </div>
</section>

<section class="main post non-narrow zero-top-spacing">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    每周Paper精读(1) Understanding Deep Learning Requires Rethinking Generalization

</div>

                    <div class="initials"><a href="https://orianna-zzo.github.io/"></a></div>
                </div>
                <div class="meta">
                    <div style="display: flex">
                        
                        <div class="date" title='2018-03-14  Wednesday  10:40:55'>2018-03-14  Wednesday  10:40:55</div>
                        
  
                        
                        <div class="reading-time"><div class="middot"></div>One minute read</div>
                        
                    </div>
                    <div style="display: flex;">
                        
                        <div class="page-tag">
                            <div class="page-tag">series:</div>
                            
                            <div class="page-tag" id="series">
                                
                                <a href="https://orianna-zzo.github.io/series/%E6%AF%8F%E5%91%A8paper%E7%B2%BE%E8%AF%BB">每周Paper精读</a> 
                                
                            </div>
                            
                        </div>
                        

                        
                        <div class="page-tag">
                            <div class="page-tag">category: </div>
                            
                            <div class="page-tag" id="categories">
                                
                                <a href="https://orianna-zzo.github.io/categories/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB">论文精读</a> 
                                
                            </div>
                            
                        </div>
                        
                    </div>

                    
                    <div class="page-tag">
                        <div class="page-tag">tags: </div>
                        
                        <div class="page-tag" id="tags">
                            
                            <div class="page-tag">
                                <a href="https://orianna-zzo.github.io/tags/deep-learning">deep learning</a>
                            </div>
                            
                            <div class="page-tag">
                                <a href="https://orianna-zzo.github.io/tags/generalization">generalization</a>
                            </div>
                            
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            <div class="markdown">
                

<h2 id="前言">前言</h2>

<p>上周五小仓鼠说有篇论文很有意思，问我看过没，是ICLR 2017 的 Best Paper [Zhang et al. 2017] Understanding Deep Learning Requires Rethinking Generalization。汗颜的确很久没有关心会议论文，现在更多都是关心项目技术点方向的论文。这篇论文一看的确很有意思，而且在学术界引起了非常激烈的讨论。有些人认为论文深度不够，提出的观点在泛化的理论学界已经研究很久，更偏向于实验报告不足以Best Paper，有人说中间有些逻辑问题，也有不少人觉得是对传统理论发起进攻的flag。这引起了我的兴趣，于是替换了我最近打算实现的NER的论文作为精读系列第一篇。</p>

<p><a href="https://arxiv.org/abs/1611.03530">Zhang C, Bengio S, Hardt M, et al. Deep Learning Requires Rethinking Generalization[C]// International Conference on Learning Representation. 2017:1-14.</a></p>

<h2 id="论文概要">论文概要</h2>

<p>作者通过一系列实验，展现出神经网络强大的拟合能力及现有的正则化方法的局限性，并提出传统机器学习中的泛化理论并不适用于深度学习，并说明即使在线性模型中，泛化理论实际上也没这么简单。</p>

<h3 id="contributions">Contributions</h3>

<ol>
<li><p>展现神经网络的强大拟合能力</p>

<p>通过不同程度随机或根据一定规则修改数据集标签（部分错误的标签数据集、随机标签的数据集）及修改数据集图片（图片的像素点打乱的数据集(shuffled、random，前者根据打乱一部分像素，后者完全打乱)、根据高斯分布生成的新数据集）两种方式来进行实验，使用随机梯度下降SGD并使用相同的超参，(Figure 1)<strong>发现Inception模型在CIFAR10的各种数据集上都能100%拟合，只是不同噪声的数据集收敛速度有所不同（但也相差并没有太多），而一旦开始收敛，都能很快拟合。随机标签被认为是对数据的一次transformation，也就是说学习算法的uniform stability和训练数据的标签是独立的</strong>。</p>

<p>作者还提出不同于之前在&rdquo;population level&rdquo;对于特定function family在整个领域的表达能力，认为需要关注给定样本大小\(n\)情况下，也就是有限样本的网络的表达能力，并在文中证明<strong>2层使用ReLU作为激活函数并有\(2n+d\)参数的神经网络就已经有足够的capacity去表示\(d\)维的样本大小为\(n\)数据集</strong>。</p></li>

<li><p>现有显式正则化方法的局限性</p>

<p>通过在真实数据集和随机标签数据集(CIFAR10、ImageNet2012)上，分别对不同的显式正则化方法(explicit regularization)进行试验，发现(Table 1&amp;2)：</p>

<ul>
<li>random crop的数据增强方法在CIFAR10中使用不同网结构络(Inception、Alexnet)的试验中基本都能提高3%~4%的测试准确率，在ImageNet中能提高10%甚至以上。</li>
<li>Weight decay(\(l2\)正则化)在CIFAR10中能提高1%左右测试准确率，但有时会降低0.1% ~ 0.3%（Inception使用数据增强、MLP1层），在ImageNet中提高了6% ~ 8%（没有CIFAR10降低的对比情况）。</li>
<li>dropout并没有控制变量的对比试验。</li>
<li>即使加入了显式正则化方法(explicit regularization)，随机标签的数据集一样能有很高的拟合程度，CIFAR10都能达到99%以上，ImageNet中最低的也有87%，其他也都在90%以上。</li>
</ul>

<p>基于以上发现，作者认为在CIFAR10上explicit regularization只提高了4% ~ 5%，在ImageNet上也只提高了18%，不算数据增强部分，在CIFAR10上提高1%，在ImageNet也有9% ~12%的提高。<strong>相比于改进网络结构，explicit regularization提高并不明显、不是必须步骤，而有些网络模型本身就具有了一定的泛化能力</strong>。此外，即使加入了正则化方法，训练集上的error还是能保持在很低的水平，作者认为<strong>显式正则化可能提高了模型的泛化能力，但对控制泛化误差不是必要的也并不足够</strong>。</p></li>

<li><p>隐式正则化</p>

<p><strong>Early stopping、Batch normalization</strong>尽管不是为了解决泛化问题，但都对模型的泛化有一定帮助(Figure 2)，<strong>被作者认为是implicit regularizer</strong>。通过对于线性模型中的随机梯度下降算法的研究分析及在MNIST和CIFAR10上的实验，<strong>作者提出SGD本身也是一种implicit regularizer。</strong></p>

<p><strong>但不管是显式正则化还是隐式正则化在合适地调参后能帮助提高泛化能力，但都移去后模型依旧有不错的泛化能力，所以并不是泛化的基本原因</strong>。</p></li>
</ol>

<h3 id="争议点">争议点</h3>

<ol>
<li><p>泛化理论研究角度来说并无亮点贡献</p>

<p>主要引起研究泛化理论学者不满的主要是作者提出的对于传统机器学习算法中的泛化理论的研究实际上在泛化理论界已经有广泛的研究了（尽管作者在论文中有提到这点），而作者对于这个并没有提出更为进一步研究和思考。这也是很多人反对这篇论文作为Best Paper，甚至觉得只是一篇实验报告的原因。</p></li>

<li><p>对于深度学习模型来说，显式正则化并非效果不如模型结构改进这一观点有些武断。</p>

<p>就如作者的实验来说，在ImageNet中所有显式正则化效果提升了18%，在CIFAR10上也有5%，这两者上的提高程度还是很巨大的，并不能得出正则化效果微弱，更无证据支撑模型结构的改进更为重要这一个结论。</p></li>
</ol>

<h3 id="疑惑之处">疑惑之处</h3>

<blockquote>
<p>到底怎样的机制可以被称为正则化？</p>
</blockquote>

<p><a href="https://en.wikipedia.org/wiki/Regularization_%28mathematics%29">Wiki</a>中对于正则化介绍说是应用在ill-posed不适定问题最优化的目标函数中的技巧，是提高模型泛化能力的技巧。</p>

<p>据我之前的理解，正则化是为了防止过拟合，提高模型的泛化能力。就形式化而言，指目标函数中单独的后缀项，用来惩罚系数太大的问题，或者说制定系数的规则。一般泛化能力都是通过计算训练集和测试集的错误率差来进行衡量。也就是说，我理解中符合形式化表述的是正则化项，目标是提高泛化能力，但正则化并不是提高模型泛化能力的唯一方法。所以作者把所有提高泛化能力的手段都称为正则化，是与我理解的体系架构有很大不同的地方。</p>

<p>发现ICML2010就已经有一篇论文<a href="http://www.ms.k.u-tokyo.ac.jp/2010/ICML2010a.pdf">Implicit Regularization in Variational Bayesian Matrix Factorization</a>提到implicit regularization，但文中并没有直接定义implicit regularization，更多提到有regularizaiton effect但没有显式使用正则化。作者的思路也沿袭这个思路。直觉上这样说，对于方法A，如果使用A会比不使用A会使得模型泛化能力提高，那么A就是正则化，如果A是为了正则化设计的，就是显式正则化，反之，就是隐式正则化。如果从“只要提高泛化能力的手段都是正则化方法”这个角度思考，迫使模型泛化能力提高，也相当于隐形地给参数加上了镣铐不往更复杂的方向走，也的确有理由称之为regularization。</p>

<p>所以作者将数据增强也认为是显式正则化的手段之一。而在我理解的系统框架中，数据增强是与正则化并列的防止过拟合的方法。训练数据越多，模型效果越好是我们已有的共识。数据增强其中一个非常重要的作用是为了增加噪声来扩充数据集，与此同时使模型更关注鲁棒的通用特征（比如说尺度不变等），与之前提到的regularization的描述也相符。一句题外话，作者使用数据增强说明能够使模型泛化能力提高的对比实验中，使用数据增强的数据集比不使用数据增强的数据集要多许多，所以具体是数据增强使泛化能力提高还是更多的数据的效果很难判断。当然现实当中，我们总是会使用最多的数据来进行建模。</p>

<p>而其他手段，比如说作者发现early stopping等也能提高泛化能力，于是被分为implicit regularizer。<a href="https://en.wikipedia.org/wiki/Regularization_%28mathematics%29">Wiki</a>中也将early stopping收入regularization中，理由是在训练过程中参数总是趋向于随着迭代次数增加而变得越来越发复杂，在validation set中没有提高时提早结束训练能够控制算法的复杂性。同样的还有batch normalization和stochastic gradient descent (SGD)，由于提高了模型泛化能力而被认为是隐式正则化，作者也尝试在线性模型上证明SGD的原因。</p>

<h2 id="进一步阅读与了解">进一步阅读与了解</h2>

<p><a href="https://stats.stackexchange.com/questions/316240/implicit-regularization-in-sgd-on-linear-model">线性模型的SGD中implicit regularization符合最小\(l2\)正则证明</a></p>

<p><a href="http://www.offconvex.org/2017/12/08/generalization1/">Generalization Theory and Deep Nets, An introduction</a> 几个教授的blog，都和最优化有关，有时间都要学习下。这篇主要进行了泛化理论的入门介绍。</p>

<p><a href="https://changkun.us/archives/2018/02/245/#more"> A breif history of Regularization</a> 给出了非常清晰的正则化历史脉络</p>

<h2 id="版本控制">版本控制</h2>

<table>
<thead>
<tr>
<th>Version</th>
<th>Action</th>
<th>Time</th>
</tr>
</thead>

<tbody>
<tr>
<td>1.0</td>
<td>Init</td>
<td>2018-03-14</td>
</tr>
</tbody>
</table>

                <br>
                <p class="back-to-posts"><a href="https://orianna-zzo.github.io/blog/">Back to posts</a></p>
            </div>
            <br>
            <div class="disqus">
                
            </div>
            
        </div>
    </div>
</section>










</body>
</html>

